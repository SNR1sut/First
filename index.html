<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HAPPY BIRTHDAY Countdown</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #0a0a0f;
    font-family: monospace;
  }
  canvas {
    position: absolute;
    top: 0;
    left: 0;
  }
  #matrix { z-index: 1; }
  #countdownCanvas { z-index: 20; pointer-events: none; display: none; }
</style>
</head>
<body>

<canvas id="matrix"></canvas>
<canvas id="countdownCanvas"></canvas>

<script>
// -------------------- CONFIG --------------------
const themeColors = ['#FFD700','#FFB6C1','#FF69B4','#DA70D6','#BA55D3','#FFA07A','#FFFACD'];
function randomColor(){ return themeColors[Math.floor(Math.random()*themeColors.length)]; }

const matrixLetters = "HAPPY BIRTHDAY â™¥".split("");
const fontSize = 20;

// -------------------- MATRIX --------------------
const matrixCanvas = document.getElementById('matrix');
const ctxMatrix = matrixCanvas.getContext('2d');
let width = window.innerWidth;
let height = window.innerHeight;
matrixCanvas.width = width;
matrixCanvas.height = height;

let columns = Math.floor(width / fontSize);
let drops = Array(columns).fill(0);
let offsets = Array(columns).fill(0).map(()=>Math.floor(Math.random()*matrixLetters.length));

function drawMatrix() {
  ctxMatrix.fillStyle = "rgba(10,10,15,0.05)";
  ctxMatrix.fillRect(0,0,width,height);
  ctxMatrix.font = fontSize+"px monospace";
  for(let i=0;i<columns;i++){
    const char = matrixLetters[(drops[i]+offsets[i])%matrixLetters.length];
    ctxMatrix.fillStyle = randomColor();
    ctxMatrix.fillText(char,i*fontSize,drops[i]*fontSize);
    drops[i]++;
    if(drops[i]*fontSize>height && Math.random()>0.975){
      drops[i]=0;
      offsets[i]=Math.floor(Math.random()*matrixLetters.length);
    }
  }
}

// -------------------- PARTICLES --------------------
const countdownCanvas = document.getElementById('countdownCanvas');
const ctxCountdown = countdownCanvas.getContext('2d');
countdownCanvas.width = width;
countdownCanvas.height = height;
const particles = [];
let countdownStarted = false;
let finalStage = false;

class Particle {
  constructor(x,y,color){
    this.x=Math.random()*width;
    this.y=Math.random()*height;
    this.destX=x;
    this.destY=y;
    this.size=2+Math.random()*2;
    this.vx=(Math.random()-0.5)*6;
    this.vy=(Math.random()-0.5)*6;
    this.color=color;
    this.baseColor=color;
  }
  update(){
    const dx=this.destX-this.x;
    const dy=this.destY-this.y;
    this.vx+=dx*0.02;
    this.vy+=dy*0.02;
    this.vx*=0.85;
    this.vy*=0.85;
    this.x+=this.vx;
    this.y+=this.vy;
    if(finalStage && Math.random()<0.02){
      const alpha=0.4+Math.random()*0.6;
      this.color=`rgba(255,255,200,${alpha})`;
    } else this.color=this.baseColor;
  }
  draw(){
    ctxCountdown.beginPath();
    ctxCountdown.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctxCountdown.fillStyle=this.color;
    ctxCountdown.fill();
  }
}

// -------------------- PARTICLE CREATION --------------------
function createParticles(text, isFinal = false){
  particles.length = 0;
  const offCanvas = document.createElement('canvas');
  offCanvas.width = width;
  offCanvas.height = height;
  const offCtx = offCanvas.getContext('2d');

  // Adjust font size
  let fSize = isFinal ? 90 : Math.min(width*0.2, 180); // smaller for final text, bigger for numbers
  offCtx.font = `bold ${fSize}px sans-serif`;
  offCtx.textAlign = 'center';
  offCtx.textBaseline = 'middle';
  offCtx.fillStyle = randomColor();
  offCtx.shadowColor = "#FFD700";
  offCtx.shadowBlur = 50;
  offCtx.fillText(text,width/2,height/2);

  const imgData = offCtx.getImageData(0,0,width,height);
  for(let y=0;y<height;y+=6){
    for(let x=0;x<width;x+=6){
      const idx=(y*width+x)*4;
      if(imgData.data[idx+3]>150) particles.push(new Particle(x,y,randomColor()));
    }
  }
}

// -------------------- COUNTDOWN --------------------
function startCountdown(){
  if(countdownStarted) return;
  countdownStarted = true;

  setTimeout(()=>{
    let i = 3;
    createParticles(i.toString());
    countdownCanvas.style.display='block';

    const interval = setInterval(()=>{
      i--;
      if(i>0) createParticles(i.toString());
      else{
        clearInterval(interval);
        // FINAL TEXT SEQUENCE
        const sequence = ["HAPPY BIRTHDAY","TO","SENGRA LAHPAI","5.1.2001"];
        let idx = 0;
        function nextText(){
          finalStage = true;
          createParticles(sequence[idx],true);
          idx++;
          if(idx<sequence.length) setTimeout(nextText,2500);
        }
        setTimeout(nextText,1500);
      }
    },1800);
  },2000);
}

// -------------------- ANIMATE --------------------
function drawParticles(){
  for(const p of particles){ p.update(); p.draw(); }
}

function animate(){
  drawMatrix();
  if(countdownStarted){
    ctxCountdown.clearRect(0,0,width,height);
    drawParticles();
  }
  requestAnimationFrame(animate);
}

// -------------------- RESIZE --------------------
window.addEventListener('resize',()=>{
  width=window.innerWidth;
  height=window.innerHeight;
  matrixCanvas.width=width;
  matrixCanvas.height=height;
  countdownCanvas.width=width;
  countdownCanvas.height=height;
  columns=Math.floor(width/fontSize);
  drops=Array(columns).fill(0);
  offsets=Array(columns).fill(0).map(()=>Math.floor(Math.random()*matrixLetters.length));
});

// -------------------- START --------------------
startCountdown();
animate();
</script>
</body>
</html>
