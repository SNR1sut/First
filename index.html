<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <title>Falling Particle Countdown & Happy Birthday Background</title>
Â  <style>
Â  Â  html, body {
Â  Â  Â  margin: 0; padding: 0; overflow: hidden; height: 100%;
Â  Â  Â  background: black;
Â  Â  }
Â  Â  canvas {
Â  Â  Â  display: block;
Â  Â  Â  position: fixed;
Â  Â  Â  top: 0; left: 0;
Â  Â  Â  width: 100vw; height: 100vh;
Â  Â  }
Â  Â  .heart {
Â  Â  Â  position: fixed;
Â  Â  Â  width: 20px;
Â  Â  Â  height: 20px;
Â  Â  Â  background: #ff69b4;
Â  Â  Â  transform: rotate(45deg);
Â  Â  Â  animation: float 5s infinite ease-in;
Â  Â  Â  pointer-events: none;
Â  Â  Â  z-index: 10;
Â  Â  }
Â  Â  .heart::before, .heart::after {
Â  Â  Â  content: '';
Â  Â  Â  position: absolute;
Â  Â  Â  width: 20px;
Â  Â  Â  height: 20px;
Â  Â  Â  background: #ff69b4;
Â  Â  Â  border-radius: 50%;
Â  Â  }
Â  Â  .heart::before {
Â  Â  Â  top: -10px;
Â  Â  Â  left: 0;
Â  Â  }
Â  Â  .heart::after {
Â  Â  Â  top: 0;
Â  Â  Â  left: -10px;
Â  Â  }
Â  Â  @keyframes float {
Â  Â  Â  0% {
Â  Â  Â  Â  bottom: -50px;
Â  Â  Â  Â  opacity: 0;
Â  Â  Â  }
Â  Â  Â  50% {
Â  Â  Â  Â  opacity: 1;
Â  Â  Â  }
Â  Â  Â  100% {
Â  Â  Â  Â  bottom: 100%;
Â  Â  Â  Â  opacity: 0;
Â  Â  Â  }
Â  Â  }
Â  </style>
</head>
<body>

<canvas id="canvas"></canvas>

<script>
Â  const canvas = document.getElementById('canvas');
Â  const ctx = canvas.getContext('2d');
Â  let W, H;

Â  function resize() {
Â  Â  W = window.innerWidth;
Â  Â  H = window.innerHeight;
Â  Â  canvas.width = W;
Â  Â  canvas.height = H;
Â  }
Â  window.addEventListener('resize', resize);
Â  resize();

Â  // Text steps for countdown and final message
Â  const steps = ["3", "2", "1", "ðŸŽ‰ Happy Birthday! ðŸŽ‰"];
Â  let stepIndex = 0;

Â  // Particle class
Â  class Particle {
Â  Â  constructor(x, y, destX, destY) {
Â  Â  Â  this.x = x;
Â  Â  Â  this.y = y;
Â  Â  Â  this.destX = destX;
Â  Â  Â  this.destY = destY;
Â  Â  Â  this.size = 2 + Math.random();
Â  Â  Â  this.speedY = 2 + Math.random()*2; // falling speed
Â  Â  Â  this.color = `rgba(204,102,255,${0.5 + Math.random() * 0.5})`;
Â  Â  }
Â  Â  update() {
Â  Â  Â  // Fall down
Â  Â  Â  this.y += this.speedY;
Â  Â  Â  if(this.y > H) {
Â  Â  Â  Â  this.y = -10 - Math.random()*100; // restart above screen
Â  Â  Â  Â  this.x = Math.random()*W;
Â  Â  Â  }
Â  Â  }
Â  Â  draw() {
Â  Â  Â  ctx.beginPath();
Â  Â  Â  ctx.arc(this.x, this.y, this.size, 0, Math.PI*2);
Â  Â  Â  ctx.fillStyle = this.color;
Â  Â  Â  ctx.fill();
Â  Â  }
Â  }

Â  let particles = [];
Â  const density = 6; // pixel step for sampling text

Â  // Generate target positions for particles from text
Â  function createTextTargets(text) {
Â  Â  const offscreen = document.createElement('canvas');
Â  Â  offscreen.width = W;
Â  Â  offscreen.height = H;
Â  Â  const offCtx = offscreen.getContext('2d');

Â  Â  // Clear
Â  Â  offCtx.clearRect(0,0,W,H);

Â  Â  // Font size depending on screen width
Â  Â  let fontSize = W < 400 ? 120 : W < 700 ? 180 : W < 1100 ? 250 : 320;
Â  Â  offCtx.font = `bold ${fontSize}px sans-serif`;
Â  Â  offCtx.textAlign = 'center';
Â  Â  offCtx.fillStyle = 'white';
Â  Â  offCtx.fillText(text, W/2, H/2 + fontSize/3);

Â  Â  let targets = [];
Â  Â  let imageData = offCtx.getImageData(0,0,W,H);

Â  Â  for(let y = 0; y < H; y += density) {
Â  Â  Â  for(let x = 0; x < W; x += density) {
Â  Â  Â  Â  let idx = (y * W + x) * 4;
Â  Â  Â  Â  if(imageData.data[idx + 3] > 128) { // opaque pixel
Â  Â  Â  Â  Â  targets.push({x, y});
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }
Â  Â  return targets;
Â  }

Â  // Initialize particles randomly over screen
Â  function initParticles(count) {
Â  Â  particles = [];
Â  Â  for(let i = 0; i < count; i++) {
Â  Â  Â  particles.push(new Particle(Math.random()*W, Math.random()*H, 0, 0));
Â  Â  }
Â  }

Â  // Assign target positions to some particles to "form" the text shape
Â  function assignTargets(targets) {
Â  Â  // Shuffle particles for random assignment
Â  Â  let shuffledParticles = particles.slice();
Â  Â  shuffledParticles.sort(() => Math.random() - 0.5);

Â  Â  for(let i = 0; i < particles.length; i++) {
Â  Â  Â  if(i < targets.length) {
Â  Â  Â  Â  particles[i].destX = targets[i].x;
Â  Â  Â  Â  particles[i].destY = targets[i].y;
Â  Â  Â  } else {
Â  Â  Â  Â  // No target, keep falling randomly
Â  Â  Â  Â  particles[i].destX = null;
Â  Â  Â  Â  particles[i].destY = null;
Â  Â  Â  }
Â  Â  }
Â  }

Â  // Update particles
Â  function updateParticles() {
Â  Â  for(let p of particles) {
Â  Â  Â  if(p.destX !== null && p.destY !== null) {
Â  Â  Â  Â  // Particle should try to fall near its target x and y
Â  Â  Â  Â  // We'll make it fall vertically and adjust x a bit towards target

Â  Â  Â  Â  p.y += p.speedY;
Â  Â  Â  Â  if(p.y > H) p.y = -10 - Math.random()*100;

Â  Â  Â  Â  // Slight horizontal correction to move towards destX
Â  Â  Â  Â  let dx = p.destX - p.x;
Â  Â  Â  Â  p.x += dx * 0.05;

Â  Â  Â  Â  // When near destination vertically, reset to above for continuous falling
Â  Â  Â  Â  if(p.y > p.destY) {
Â  Â  Â  Â  Â  p.y = -10 - Math.random()*100;
Â  Â  Â  Â  Â  p.x = Math.random()*W;
Â  Â  Â  Â  }
Â  Â  Â  } else {
Â  Â  Â  Â  // Free falling particle with no target
Â  Â  Â  Â  p.update();
Â  Â  Â  }
Â  Â  }
Â  }

Â  // Draw particles
Â  function drawParticles() {
Â  Â  for(let p of particles) {
Â  Â  Â  p.draw();
Â  Â  }
Â  }

Â  // Main animation loop
Â  let stepTargets = [];
Â  let stepDuration = 4000; // ms for each countdown step + final text
Â  let stepStartTime = null;

Â  // Hearts floating effect

Â  function createHeart() {
Â  Â  const heart = document.createElement("div");
Â  Â  heart.className = "heart";
Â  Â  const size = W < 400 ? 12 : W < 700 ? 16 : 20;
Â  Â  heart.style.width = size + "px";
Â  Â  heart.style.height = size + "px";
Â  Â  heart.style.left = Math.random() * 100 + "vw";
Â  Â  heart.style.animationDuration = (4 + Math.random() * 3) + "s";
Â  Â  document.body.appendChild(heart);
Â  Â  setTimeout(() => heart.remove(), 7000);
Â  }

Â  let heartsInterval = null;
Â  function startHearts() {
Â  Â  if(heartsInterval) return;
Â  Â  heartsInterval = setInterval(createHeart, 300);
Â  }

Â  function animate(time = 0) {
Â  Â  if(!stepStartTime) stepStartTime = time;
Â  Â  ctx.clearRect(0, 0, W, H);

Â  Â  // Draw black translucent bg for trailing effect
Â  Â  ctx.fillStyle = "rgba(0,0,0,0.1)";
Â  Â  ctx.fillRect(0, 0, W, H);

Â  Â  // Draw falling particles and text shape
Â  Â  updateParticles();
Â  Â  drawParticles();

Â  Â  // Handle step timing
Â  Â  if(time - stepStartTime > stepDuration) {
Â  Â  Â  stepIndex++;
Â  Â  Â  if(stepIndex >= steps.length) {
Â  Â  Â  Â  // Final step reached - keep last text and start hearts
Â  Â  Â  Â  startHearts();
Â  Â  Â  Â  stepIndex = steps.length - 1; // stop incrementing
Â  Â  Â  } else {
Â  Â  Â  Â  // Prepare next step
Â  Â  Â  Â  stepTargets = createTextTargets(steps[stepIndex]);
Â  Â  Â  Â  assignTargets(stepTargets);
Â  Â  Â  Â  stepStartTime = time;
Â  Â  Â  }
Â  Â  }

Â  Â  requestAnimationFrame(animate);
Â  }

Â  // Start first step
Â  stepTargets = createTextTargets(steps[0]);
Â  initParticles(1000); // number of particles total
Â  assignTargets(stepTargets);

Â  animate();

</script>

</body>
</html>
